spring:
  application:
    name: pos-backend

  # Configure multipart file uploads (max 5MB)
  servlet:
    multipart:
      max-file-size: 5MB
      max-request-size: 10MB

  # Configure static resource mapping for file uploads
  web:
    resources:
      # Use environment variable for Docker compatibility, fallback to local uploads directory
      static-locations: file:${UPLOAD_BASE_PATH:uploads}/,classpath:/static/

  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:pos_db}
    username: ${DB_USER:postgres}
    password: ${DB_PASSWORD:password}
    driver-class-name: org.postgresql.Driver
  
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: ${SHOW_SQL:false}
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        # Batch fetch size for lazy-loaded collections (optimization)
        default_batch_fetch_size: 10
        jdbc:
          fetch_size: 10

  jackson:
    serialization:
      write-dates-as-timestamps: false
    time-zone: UTC

  # Email Configuration
  mail:
    host: ${MAIL_HOST:smtp.hostinger.com}
    port: ${MAIL_PORT:587}
    username: ${MAIL_USERNAME:noreply@fascinito.in}
    password: ${MAIL_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          connectiontimeout: 5000
          timeout: 5000
          writetimeout: 5000
    default-encoding: UTF-8

  # Thymeleaf Configuration
  thymeleaf:
    prefix: classpath:/templates/
    suffix: .html
    mode: HTML
    cache: false
    encoding: UTF-8

server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /api
  # Enable HTTP compression for better performance
  compression:
    enabled: true
    min-response-size: 1024  # 1KB minimum size to compress
    compressed-mime-types:
      - text/html
      - text/xml
      - text/plain
      - text/css
      - text/javascript
      - application/javascript
      - application/json
      - application/xml+rss
      - application/rss+xml
      - image/jpeg
      - image/png
      - image/gif
      - image/webp
      - image/svg+xml

jwt:
  secret: ${JWT_SECRET:yourSecretKeyForJWTTokenGenerationMustBeLongEnoughForHS256Algorithm}
  access-token-expiration: ${JWT_ACCESS_EXPIRATION:3600000} # 1 hour in milliseconds
  refresh-token-expiration: ${JWT_REFRESH_EXPIRATION:604800000} # 7 days in milliseconds

cors:
  allowed-origins: ${CORS_ORIGINS:http://localhost:3000,http://localhost:5173}
  allowed-methods: GET,POST,PUT,DELETE,PATCH,OPTIONS
  allowed-headers: "*"
  allow-credentials: true

# Razorpay Configuration
razorpay:
  key-id: ${RAZORPAY_KEY_ID:rzp_test_your_key_id}
  key-secret: ${RAZORPAY_KEY_SECRET:your_key_secret}
  currency: ${RAZORPAY_CURRENCY:INR}

# Custom App Configuration
app:
  mail:
    from: "Fascinito <noreply@fascinito.in>"
    admin: ${ADMIN_EMAIL:admin@fascinito.in}
  invoice:
    upload-path: ${UPLOAD_BASE_PATH:uploads}/invoices
    base-url: ${API_BASE_URL:http://localhost:8080}

logging:
  level:
    com.fascinito: ${LOG_LEVEL:DEBUG}
    org.springframework.security: ${LOG_LEVEL:DEBUG}
